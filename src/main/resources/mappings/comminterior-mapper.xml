<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="commInteriorDAO">
  	<insert id="insertComm" parameterType="CommInteriorVO">
  		{ call
  		declare
  		begin
  		INSERT INTO COMMUNITY
  		(COM_SEQ, TITLE, NICKNAME, CONTENT, REGDATE, HIT, LIKES, TYPE)
  		VALUES ((COMMMUNITY_SEQ.NEXTVAL) + 1, #{title}, #{nickname},
  			#{content}, SYSDATE, 0, 0, 2);
  		INSERT INTO COMM_INTERIOR (COM_SEQ, FILE_IMAGE)
  		VALUES ((select NVL(MAX(com_seq),0)from community), #{file_image});
  		END
  		}
  	</insert>
  	
   	<update id="updateComm" parameterType="CommInteriorVO">
	  	{ call
  		declare
  		begin
  		UPDATE COMMUNITY
  		SET TITLE = #{title}, CONTENT = #{content}, REGDATE = SYSDATE
  		WHERE COM_SEQ = #{com_seq};
  		UPDATE COMM_INTERIOR
  		SET FILE_IMAGE = #{file_image}
  		WHERE COM_SEQ = #{com_seq};
  		END
  		}
	</update>
	
   	<update id="deleteComm" parameterType="CommInteriorVO">
  		
	</update>
  
	<select id="InteriorAll" resultType="CommInteriorVO">
		SELECT C.COM_SEQ, C.TITLE, C.NICKNAME, C.CONTENT, C.REGDATE, C.HIT, C.LIKES, I.FILE_IMAGE
		FROM COMMUNITY C, COMM_INTERIOR I
		WHERE C.COM_SEQ = I.COM_SEQ
		ORDER BY C.COM_SEQ , I.COM_SEQ
	</select>
  
	<select id="getInteriorOne" parameterType="CommInteriorVO" resultType="CommInteriorVO">
		SELECT C.COM_SEQ, C.TITLE, C.NICKNAME, C.CONTENT, C.REGDATE, C.HIT, C.LIKES, I.FILE_IMAGE
		FROM COMMUNITY C, COMM_INTERIOR I
		WHERE C.COM_SEQ = I.COM_SEQ
		AND C.COM_SEQ = #{com_seq}
		ORDER BY C.COM_SEQ , I.COM_SEQ
	</select>
  </mapper>